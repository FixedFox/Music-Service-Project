# Сервис каталогизации музыки и слежения за подписками

Выпускной проект для *Java-школы Сбера* от **Горшкова Ивана**

Сервис написан с применением следующих технологий:
+ Java 11 (Adoptium OpenJDK Temurin 11)
+ Spring Boot (2.7.18) (стартеры: web, data-jpa, validation, security)
+ PostgreSQL 16

## Что необходимо для запуска

Наличие на компьютере JDK 11 и базы данных PostgreSQL 16. В проект будут приложены .sql файлы для создания схемы
базы данных, а также файл для её демонстрационного наполнения.
baseInitialization.sql - cтруктура базы.
content.sql - демонстрационное наполнение.

## Как разворачиват проект
Скачать репозиторий. В файлах sql будут находиться:
+ Скрипт для создания базы
+ Скрипт для наполнения базы заготовленными данными: пользователями, композициями, альбомами, жанрами и связями между ними

После заполнения базы подключаем её через параметры в application.yml.
Запускаем проект по адресу localhost:8080.
Функциональность интеграции с ботом в телеграме реализована на странице _Пользователь_.
Необходимо сохранить введёный никнейм (без собачки) в поле. Нажать "Сохранить". Затем открыть бота, запустить его коммандой
__/start__. На странице пользователя при нажатии на ссылку _Проверить_ должна произойти привязка Аккаунта пользователя
к системе уведомлений сервиса, а также придёт сообщение _Привет, {name}_. Если статус сменился на Подключен, значит, все
в поряке.

## Функционал проекта

### Роли

+ Пользователь
+ Музыканты

### Права ролей

#### Пользователь

Пользователь собирает свою коллецию мызки из предложенного на сервисе.
Он может добавлять себе в коллекцию Композиции, а также подписываться на Авторов (их можно будет посмотреть в разделе "Подписки").
Для выбора композиций, которые можно добавить в коллекцию, а также Авторов, на которых можно подписаться, предусмотрена страница
поиска, на которой присутствуют два поля: поиск композиций (ищет не только по названиям композиций, но и по названиям альбомов,
и названиям Авторов) и отдельно поиск авторов, далее расскажу об этом подробнее.
Добавленные композиции можно посмотреть в разделе Библиотека, в котором они разделены по способам представления.
Раздел Библиотека -> Композиции показывает все добавленные Композиции.
Раздел Библиотека -> Альбомы отображает все альбомы, которые привязаны к композициям, а также позволяет при нажатии на конкретное
название получить список композиций альбома, которые были добавлены.
Раздел Библиотека -> Авторы показывает все Альбомы данного автора, композиции из которых добавил пользователь.
Раздел Библиотека -> Жанры отображает все жанры композиций, которые добавил пользователь.

Раздел Поиск содержит два поля для поиска:
+ Поиск Композиций
+ Поиск Авторов

Поиск в первом поле осуществляется по введённому значению названий композиций, авторов, альбомов и ранжируется
по колличеству прослушиваний у трека, и выводит только те композиции, Альбомы с которыми опубликованы.
Чтобы увидеть все доступное в сервисе, надо оставить поле пустым. Эти композиции можно добавлять в коллекцию.

Поиск во втором поле отображает Авторов, на которых можно подписаться, чтобы получать уведомления в Telegram о публикации
их новых альбомов.

Раздел Подписки показывает Авторов, за чьими публикациями будет следить пользователь.

Так же на странице пользователя присутствует функционал смены пароля и добавления аккаунта Telegram для получения уведомлений о
публикации новых альбомов.

Ещё присутствует функционал добавления Авторов. Добавляя своего первого автора, пользователь получает права Музыканта.

#### Музыкант

Всё то же самое, что и у пользователя, плюс у него добавляется функционал Панели музыканта. 
Она предназначена для того, чтобы добавлять композиции в сервис и собирать из этих композиций альбомы, а так же добавлять
музыкальные жанры, которые присваиваются композициям или альбомам в процессе их добавления или редактирования. Музыкант имеет
возможность распоряжаться только собственными добавленными в сервис Композициями, Альбомами и Авторами. Жанры можно удалять 
только в том случае, если отсутствуют композиции с этим жанром (другими словами, жанр не привязан к пользователю).

Что делать для проверки функционала музыканта?
Сначала добавляется жанр. Затем добавляются композиции и альбомы, после им присваиваются исполнители. Далее необходимо
опубликовать альбом, чтобы он стал доступен для поиска на сервисе, далее уже можно добавлять его в коллекцию и смотреть,
как работает каталогизация.
Если подписаться на Музыканта, то при публикации альбома с его участием в телеграм придёт сообщение о том, что альбом вышел. При этом 
добавление в альбом и добавление в композицию его как автора не вызовет событие отправки сообщения в телеграм при публикации.

Пользователи для входа:
username:password
fox:123
red:red

У пользователя fox - роль Музыкант, и присутствют несколько исполнителей.
У пользователя red - роль Пользователь, и он пустой.